<html>
	<head>
		<link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans+Condensed:300|Ubuntu|Yanone+Kaffeesatz" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans+Condensed:300" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans+Condensed:300|Ubuntu" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Cuprum|Fjalla+One|Open+Sans+Condensed:300|Ubuntu|Yanone+Kaffeesatz" rel="stylesheet">
		<style type="text/css">
			body{
			     background-color: #e1e1ea;
			background-image: url("Background3.jpg"); 
			background-position: top;
 
			background-repeat: no-repeat;
			background-size:1350px 400px;}
			
			p{display: inline-block;}
			img{display: block;}
			.container{width: 90%;position absolute;margin: auto;}
			.title{position: relative;width: 90%;margin: auto;text-align: center;font-weight: bold;font-size: 90px;padding: 1%;font-family: 'Yanone Kaffeesatz', sans-serif; color: yellow;}
			.section{position: relative;width: 90%;margin: auto;padding: 2%;}
			.subsection{position: relative; width: 98%;text-align: justify;padding: 10px;}
			.heading{position: relative; width: 98%;text-align: left;font-size: 30px;font-family: 'Ubuntu', sans-serif;}
			.text{width: 95%;font-size: 20px;text-align: justify;padding: 10px 0px 10px 0px;font-family: 'Open Sans Condensed', sans-serif;}
			.authors{position: relative;width: 80%;margin-left: 3cm;margin-top: 3.6cm;text-align: center;padding: 2%;font-size: 20px; font-family: 'Cuprum', sans-serif; color: yellow;}
			.image{width: 95%;font-size: 20px; font-align:left}
			.image2{width: 95%;font-size: 20px;font-align: right}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="title">COMMERCIAL DETECTION IN AUDIO</div>

			<div class="authors">

				<!-- Start edit here  -->
				<p>Abhishek Gupta 150108048 EEE |</p> &nbsp; &nbsp;
				<p>Suyash Pati Tripathi 150108038 EEE |</p> &nbsp; &nbsp;
				<p>Ankur Deka 150102006 ECE</p> &nbsp; &nbsp;
				<p>Parth Pawar 150108022 EEE |</p> &nbsp; &nbsp;
				<p>Nitesh Khichi 150102042 ECE</p> &nbsp; &nbsp;
				<!-- Stop edit here -->

			</div>


			<div class="section">
				<div class="heading">Abstract</div>
				<div class="text">

					<!-- Start edit here  -->
					In this work, we have developed a system that is able to detect and remove commercials from an input
					sound stream (radio broadcasts). Various features like spectral flux, zero crossings, spectral centroid,
					signal energy etc., are extracted from the audio. Then these features are fed to Kalman filter, which sets
					the value of state variable (predicted-state). Using a decision boundary with the state variable, each frame
					is classified as either advertisement or song.
					<!-- Stop edit here -->

				</div>
			</div>

			<div class="section">
				<div class="heading">1. Introduction</div>
				<div class="text">

					<!-- Start edit here  -->
					Advertisements have become ubiquitous and form a major
portion of radio broadcasts in modern times. Many listeners
are disinterested in these commercials as they tune in to listen
to radio programmes. The primary revenue stream for social
and entertainment media is advertisement and entities like
YouTube and Google depend on them for revenue.
					<br>However,
users of these social media do not like the commercial
breaks; not only is this distracting and annoying for listeners, it
also has adverse effects on consumer behavior . 
					<br>In this work
a radio stream monitoring system is designed and
implemented to detect these advertisements.
					<!-- Stop edit here -->

				</div>

				<div class="subsection">
					<div class="heading">1.1 Introduction to Problem</div>
					<div class="text">

						<!-- Start edit here  -->
						This project aims at identifying and removing commercials segments from 
						audio signals acquired from radio feeds. The audio feed is first segmented
						into a number of consecutive audio clips. 
						<br>The task is to identify specific
						features that differentiate a commercial clip from a non-commercial one.
						<!-- Stop edit here -->

					</div>
				</div>

				<div class="subsection">
					<div class="heading">1.2 Figure</div>
					<div class="image">

						<!-- Start edit here  -->
						<br>Block diagram of the project. 
						<img src="example.jpg" alt="This text displays when the image is umavailable" width="800px" height=""/>
						<!-- Stop edit here -->

					</div>
				</div>
				<div class="subsection">
					<div class="heading">1.3 Literature Review</div>
					<div class="text">

						<!-- Start edit here  -->
						<ol>
							<li><a href="https://www.ee.columbia.edu/~dpwe/papers/ScheiS97-mussp.pdf">
								CONSTRUCTION AND EVALUATION OF A ROBUST MULTIFEATURE SPEECH/MUSIC DISCRIMINATOR by <i>Eric Scheirer
								and Malcolm Slaneyy, MIT Media Laboratory, Cambridge, USA</i></a>
							<br>This paper deals with the construction of a real-time computer system capable of distinguishing 
							speech signals from music signals over a wide range of digital audio input.</li>
							<li><a href="https://www.ee.iitb.ac.in/~esgroup/es_mtech04_sem/es_sem04_paper_04307909.pdf">
								AUDIO SIGNAL CLASSIFICATION by <i>Hariharan Subramanian,M.Tech. Credit Seminar Report IITB</i></a>
							<br>This paper explains in detail various features and their use in Audio Signal Processing.</li>
							<li><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.217.3866&rep=rep1&type=pdf">
								DETECTING ADVERTISEMENT IN RADIO USING MACHINE LEARNING by <i>Robin MÂ¨uller-Cajar,University of Canterbury, Christchurch, 
								New Zealand</i></a>
							<br>This paper explains the use of Machine Learning and related algorithms in Audio Signal Processing. It also explains in details 
							about various features and their use.</li>
							<li><a href="https://courses.engr.illinois.edu/ece420/sp2017/UnderstandingKalmanFilter.pdf">
								Understanding the Basis of the Kalman Filter Via a Simple and Intuitive Derivation by <i>Ramsey Faragher, IEEE Signal 
								Processing Magazine, September 2012</i></a>
							<br>This article discusses in details about the basics of Kalman Filter.</li>
						
						</ol>
							 			<!-- Stop edit here -->

					</div>
				</div>
				<div class="subsection">
					<div class="heading">1.4 Proposed Approach</div>
					<div class="text">

						<!-- Start edit here  -->
					We focused on identifying key features in the audio stream that are only present in advertising.
					These features need to be consistent across most, if not all, advertisements, while
					also being simple to calculate.
					<br>Thus our research is split into several key steps:
						<ul> 
							<li>Research and discover features that differ between advertising and music</li>
							<li> Implement algorithms that can extract attributes corresponding to these features</li>
							<li>Use Kalman Filter algorithms to create a function with these attributes as
								inputs, and the class (advertising or music) as output</li>
						</ul>

						
						<!-- Stop edit here -->

					</div>
				</div>
				<div class="subsection">
					<div class="heading">1.5 Report Organization</div>
					<div class="text">

						<!-- Start edit here  -->
						Our report starts with the understanding and analysis of advertisements in section 1.1. 
						<br>This results in the discovery of key features that can be used to distinguish between advertising
						and music.The condensed block diagram of our proposed design is shown section 1.2 followed by various research papers and 
						related resources used in this project in section 1.3. 
						<br>The detailed approach is given in section 2. 
						<br>We implement algorithms to extract 
						these features before describing the design and implementation of Kalman Filter
						algorithms in section 3.
						<br>The results of testing the Kalman Filter algorithms are described in 3.1.
					        along with the quality of the extracted attributes. 
						Our discussion section 3.2 then attempts to explain each classifier and its performance. 
						<br>Finally we discuss our conclusions, summary and future work in section 4.
						<!-- Stop edit here -->

					</div>
				</div>
			</div>

			<div class="section">
				<div class="heading">2. Proposed Approach</div>
				<div class="subsection">
					<div class="heading">2.1 Analysing Advertising</div>
					<div class="text">

					<!-- Start edit here  -->
					Our study focused on commercial radio stations, through which we were able to find several
					attributes that differed from music.<br> We recorded several hours of radio from 93.5 Big FM,
					Vividbharti, RED FM as test data. These recordings were taken at different times of day 
					between 8am and 12pm in the last week of Octuber. <br>The advertisements that were captured in this
					manner were then analysed and compared to music in the same segments.
					<br>This gave us the following key attributes:
					<ul>
						<li><b>Speech:</b> A significant portion of advertisements contained only speech, while 
						some contained either music or other sound effects in the background.</li>
						<br><li><b>Rhythm of Speech:</b> Compared to music and the DJ, advertisements sometimes appeared
						rushed, as traders attempted to squeeze as much information into as little time as possible.</li>
						<br><li><b>Frequency Distribution:</b> Advertisements contain fewer frequencies,
						but those frequencies have been compressed to make the audio appear
						louder. The range of frequencies tends to be smaller than for music, when the
						advertisement consists of pure speech. For all advertisements the frequency
						balance is skewed more towards lower frequencies.
						<br><li><b>Volume and Volume Distribution:</b> The silent gaps between words mean that the
						average volume of speech is lower. Also the change in volume over time is
						higher for advertisements for the same reason</li>
						<br><li><b>Length of Segment:</b>An advertisement is never longer than a minute, while music
						is significantly longer.</li>
					<!-- Stop edit here -->
						</div>
					</div>	
				<div class="subsection">
					<div class="heading">2.2 Audio Analyser</div>
					<div class="text">
					<ul>
						<li><b>Spectral Analysis:</b> Music usually uses more frequencies than speech. 
							These frequencies tend to change rapidly as new notes are played. This contrasts with 
							speech where the speaker tends to remain within a thin frequency spectrum, with most 
							frequencies remaining empty. Thus if we sum how much each frequency changes
                                                        from one sample period to the next, we can gather a value for how much the audio has changed 
							in that period. This value will be higher for music or noise than for speech.
						        <br>The following classifiers were used:
								<ol>
									<li><b>Spectral flux analysis</b></li>
									<div class="image">
										<img src="Flux.png" alt="This text displays when the image is umavailable" width="229px" height="80"/>
										</div>
									<br><li><b>Spectral Centroid</b></li>
									<div class="image">
										<img src="Centroid.jpg" alt="This text displays when the image is umavailable" width="229px" height="80"/>	
										</div>
									<br><li><b>Spectral Roll-Off Frequency</b></li>
									<div class="image">
										<img src="RollOff.png" alt="This text displays when the image is umavailable" width="229px" height="80"/>
										</div>
										</ol>
							</li>
									
						<br><li><b>Extreme Frequency Values:</b>This value measures the volume distribution of the audio stream. 
							Advertising contains some very strong frequencies because it tends to heavily emphasise
							the speech frequencies, something that music usually does not. By summing the number of frequencies 
							above and below a certain threshold we obtain a good estimation.</li>
						 <br><li><b>Energy Balance:</b>The energy balance compares the sum of the frequencies above 8000Hz with the
							total sum of all frequency values. This value is significant because speech contains few frequencies 
							above 8000Hz while instruments contain significant amounts of frequencies in this range. This does
							not always hold as certain music genres such as rap often contain only speech and drums, and therefore 
							very few high frequencies for the general volume distribution.</li>
						 <br><li><b>Zero crossing:</b>Music is more continous and smooth as compared to Audio advertisement. Speech contains pauses 
						        unlike music. </li>
								<div class="image">
										<img src="zcr.jpg" alt="This text displays when the image is umavailable" width="229px" height="80" margin-left:1cm/>
										</div>
						 <br><li><b>Volume:</b>The average volume for speech tends to be lower than for music, as speech contains
							 pauses, which music does not. Volume patterns tend to be more constant for music than for speech,
							 as the latter contains many more peaks and troughs in each sample period.</li>
						<div class="image">
										<img src="Volume.png" alt="This text displays when the image is umavailable" width="229px" height="80"/>
										</div>
					
						</ul>

						
				</div>
					<div class="subsection">
					<div class="heading">2.3 Kalman Filter Algorithms - Design and Implementation</div>
					<div class="text">
						Kalman filter is a simple and fast algorithm which can be used to give an estimate of state based on erroneous sensor
						measurements. In case of linear systems, the estimate comes out to be the best. 
						It can also predict states which cannot be directly obtained from sensor measurements.
						Some applications are  in robotics, trackpad and even in the Apollo Project. 
						<br>The best thing about this filter is itâs simple mathematical structure which makes it feasible to be applied in real 
						time systems.
						<br>There are essentially 2 steps in a Kalman filter â 
						<ol>							
							<li><b>Motion/Time Update step</b></li>
							<li><b>Measurement Update Step</b></li>
						</ol>
					<div class="image">
					<img src="Kalman1.jpg" alt="This text displays when the image is umavailable" />
						</div>
						
					<br><b>Use of Kalman Filter in Commercial Detection:</b>
						We make use of a simple 1D Kalman filter which is equivalent to <i>Bayesian Filter.</i>
						Our state is a 1D variable X with associated uncertainly (variance) P. An audio file is read 
						in clips of 3 seconds and with every clip, the state is updated (through one motion update and 
						one measurement update). If the state comes as positive then the clip is considered as commercial
						and if it comes as negative it is considered music.
						<br>In every clip:
						<ol>
							<li>Features are extracted, and these features are used as used as sensor readings.</li>
							<li><b>Measurement Update:</b> The sensor readings lead to a measurement in state. X and P 
							are updated.</li>
							<li><b>Motion Update:</b> The state is moved closer to origin and the uncertainly (P) is increased.</li>
						</ol>		
						<br>Here is the justification for the approach:
						<ol>	
							<li>Since previous state has certain amount of say in the next state, the erroneous detection of commercials are
								filtered. The Kalman Filter in some sense is preventing sudden changes in  state. E.g. It is unlikely that
								a single clip of 3 seconds is commercial while all the neighbouring clips to the left and right are music.</li>
<br>
							<li>If an advertisement is running for a long time than it is likely that it will end soon. Similar is the case with 
								music. The motion update step moves the state towards origin (i.e., commercial towards music and music towards
								commercial).</li>
						</div>
					</div>
			</div>

			<div class="section">
				<div class="heading">3. Experiments &amp; Results</div>
				<div class="subsection">
					<div class="heading">3.1 Dataset Description</div>
					<div class="text">

						<!-- Start edit here  -->
						The datasheet are various audio sigmals in different radio channels. We recorded them using the <i>RadioSure</i> app.
						These recordings are mailnly from 93.7MHz BigFm, 106.4MHzVividbharti and some local channels.
						These signals were taken at regular interval between 09:00 to 22:00 for a week.
						<!-- Stop edit here -->

					</div>
				</div>
				<div class="subsection">
					<div class="heading">3.2 Result</div>
					<div class="text">
										
						<!-- Start edit here  -->
						The various graphs describing the feature analysis based on different Audio Analysers are shown below.
						<div class="image">
							<br>Zero Crossing 
					<img src="Zerocrossing.png" alt="This text displays when the image is umavailable" align="left" width="400px" height=250"/>
						</div>
						<div class="image2">
							Spectral Spread 
					<img src="SpectralSpread.png" alt="This text displays when the image is umavailable" align="right" width="400px" height="250" />
						</div>
						<div class="image">
							<br>Spectral Roll-Off Frequency
					<img src="SpectralRollOff.png" alt="This text displays when the image is umavailable" align="left" width="400px" height="250" />
						</div>
						<div class="image2">
							High Frequency Energy 
					<img src="HighFreqEnergy.png" alt="This text displays when the image is umavailable" align="right" width="400px" height="250"/>
						</div>
						<div class="image">
							<br>Spectral Flux 
					<img src="SpectralFlux.png" alt="This text displays when the image is umavailable" align="left" width="400px" height="250"/>
						</div>
						<div class="image2">
							Spectral Centroid 
					<img src="SpectralCentroid.png" alt="This text displays when the image is umavailable" align="right" width="400px" height="250"/>
						</div>
						<!-- Stop edit here -->

					</div>
				</div>
			</div>

			<div class="section">
				<div class="heading">4. Conclusions</div>
				<div class="subsection">
					<div class="heading">4.1 Summary</div>
					<div class="text">

						<!-- Start edit here  -->
						Write something here.
						<!-- Stop edit here -->

					</div>
				</div>
				<div class="subsection">
					<div class="heading">4.2 Future Extensions</div>
					<div class="text">

						<!-- Start edit here  -->
						Write something here.
						<!-- Stop edit here -->

					</div>
				</div>
			</div>

		</div>
	</body>
</html>
